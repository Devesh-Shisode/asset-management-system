<div class="container py-4">
  <div class="container-fluid">
    <!-- ðŸ”¹ Form Card -->
    <div class="card border-0 shadow-lg rounded-4 mb-5">
      <div
        class="card-header text-white"
        style="background: linear-gradient(135deg, #6a11cb, #2575fc)"
      >
        <h5 class="mb-0 fw-semibold">
          <i class="bi bi-plus-circle me-2"></i>
          {{ isEditMode ? "Update Asset" : "Add New Asset" }}
        </h5>
      </div>
      <div class="card-body">
        <form #assetForm="ngForm" (ngSubmit)="onSubmit(assetForm)">
          <div class="row g-3">
            <div class="col-sm-6 col-lg-4">
              <label class="form-label">Asset Name</label>

              <input
                type="text"
                class="form-control shadow-sm"
                placeholder="Enter asset name"
                [(ngModel)]="newAsset.name"
                name="name"
                required
              />
            </div>

            <div class="col-sm-6 col-lg-4">
              <label class="form-label">Category</label>
              <select
                class="form-select shadow-sm"
                [(ngModel)]="newAsset.categoryId"
                name="categoryId"
                required
              >
                <option value="" disabled selected>Select Category</option>
                <option *ngFor="let cat of categories" [value]="cat.categoryId">
                  <i
                    class="bi-{{ cat.name.toLowerCase() }} me-2 text-primary"
                  ></i>
                {{cat.name}}</option>
              </select>
            </div>

            <div class="col-sm-6 col-lg-4">
              <label class="form-label">Serial No</label>
              <input
                type="text"
                class="form-control shadow-sm"
                [ngClass]="{
                  'is-invalid':
                    serialExists(newAsset.serialNumber) && assetForm.submitted
                }"
                placeholder="Enter serial number"
                [(ngModel)]="newAsset.serialNumber"
                name="serialNumber"
                required
              />
            </div>

            <div class="col-sm-6 col-lg-4">
              <label class="form-label">Purchase Date</label>
              <input
                type="date"
                class="form-control shadow-sm"
                [(ngModel)]="newAsset.purchaseDate"
                name="purchaseDate"
                required
              />
            </div>

            <div class="col-sm-6 col-lg-4">
              <label class="form-label">Warranty (Months)</label>
              <input
                type="number"
                class="form-control shadow-sm"
                placeholder="e.g. 12"
                [(ngModel)]="newAsset.warrantyMonths"
                name="warrantyMonths"
                required
              />
            </div>

            <div class="col-sm-6 col-lg-4">
              <label class="form-label">Status</label>
              <select
                class="form-select shadow-sm"
                [(ngModel)]="newAsset.statusId"
                name="statusId"
                required
              >
                <option value="" disabled selected>Select Status</option>
                <option value="1">Available</option>
                <option value="2">In Use</option>
                <option value="3">Under Maintenance</option>
                <option value="4">Retired</option>
              </select>
            </div>

            <div class="col-12">
              <label class="form-label">Description</label>
              <textarea
                rows="2"
                class="form-control shadow-sm"
                placeholder="Add brief notes..."
                [(ngModel)]="newAsset.description"
                name="description"
                required
              ></textarea>
            </div>
          </div>

          <div class="d-flex flex-wrap justify-content-end gap-2 mt-4">
            <button type="submit" class="btn btn-success px-4">
              <i class="bi bi-check-circle me-1"></i>
              {{ isEditMode ? "Update" : "Add" }}
            </button>
            <button
              *ngIf="isEditMode"
              type="button"
              class="btn btn-outline-secondary px-4"
              (click)="resetForm(assetForm)"
            >
              <i class="bi bi-x-circle me-1"></i> Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- ðŸ”¹ Table Card -->
    <div class="card border-0 shadow-lg rounded-4">
      <div class="card-header bg-dark text-white">
        <h5 class="mb-0 fw-semibold">
          <i class="bi bi-box-seam me-2"></i>Asset Inventory
        </h5>
      </div>
      <div class="table-responsive">
        <table class="table table-striped table-hover align-middle text-nowrap">
          <thead class="table-light">
            <tr>
              <th>#</th>
              <th>Asset Name</th>
              <th>Category</th>
              <th>Serial No</th>
              <th>Purchase Date</th>
              <th>Warranty</th>
              <th>Status</th>
              <th>Description</th>
              <th class="text-center">Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let asset of assets; let i = index">
              <td>{{ i + 1 }}</td>
              <td>{{ asset.name }}</td>
              <td>
                <i
                  [ngClass]="
                    getCategoryIconClass(asset.categoryId) +
                    ' me-2 text-primary'
                  "
                ></i>
                {{ getCategoryName(asset.categoryId) }}
              </td>

              <td>{{ asset.serialNumber }}</td>
              <td>{{ asset.purchaseDate | date : "yyyy-MM-dd" }}</td>
              <td>{{ asset.warrantyMonths }} mo</td>
              <td>
                <span class="badge text-bg-secondary">{{
                  getStatus(asset.statusId)
                }}</span>
              </td>
              <td>{{ asset.description }}</td>
              <td>
                <div class="d-flex justify-content-center gap-2">
                  <button
                    class="btn btn-sm btn-outline-info"
                    (click)="editAsset(asset)"
                    title="Edit"
                  >
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button
                    class="btn btn-sm btn-outline-danger"
                    (click)="deleteAsset(asset.assetId!)"
                    title="Delete"
                  >
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </td>
            </tr>
            <tr *ngIf="assets.length === 0">
              <td colspan="9" class="text-center text-muted py-3">
                No assets found.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
